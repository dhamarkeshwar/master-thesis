\chapter{More efficient publicly verifiable protocols}
\label{cha:2}
This chapter introduces a new PVSS scheme that is more efficient in terms of verification time 
than the state-of-the-art PVSS $\Pi_{S}$ \cite{cryptoeprint:2023/1669}. We noticed that the 
PVSS version where the secret is $g^{f_0}$ can never be secure against a malicious dealer who 
has access to unbounded computational power. This is because a computationally unbounded 
dealer can always cheat shareholders by giving them a fake proof of knowledge about the 
public-key encryptions of the secret.\par 

Due to this reason, we can use ZK AoK proof systems to improve the overall efficiency of 
PVSS schemes. In the remainder of this chapter, we will introduce a new NIZK AoK proof system 
and use it to construct a new PVSS scheme which is based on $\Pi_S$. As a consequence, 
we will also give a new PPVSS scheme.

\section{Proof Systems based on polynomial DL}
In this subsection, we will give two NIZK AoK proof systems. The first one is a variant of 
the NIZK PoK for the polynomial DL problem which originally was introduced in \cite{cryptoeprint:2023/1669}. 
The latter is inspired from the same work but it is based on a slightly different version of 
the polynomial DL problem.

\subsection{Version 1}
\label{subsec:AoK_R_pdl}
Consider the set $\{g_i\}_{i=1}^n$ containing $n$ distinct generators (obtained as CRS) of 
the prime order $q$ cyclic group $\mathcal{G}$ different from $g$ with $g$ also being a generator of 
$\mathbb{G}$, where $n<\varphi(q)$ and $\varphi(q)$ is 
the total number of distinct generators of the cyclic group $\mathbb{G}$. Consider the following relation for 
some polynomial $f\in\mathbb{Z}_q[X]_{t}$ with $0\leq t< n$:
\begin{align}\label{eq:relation_mod_PDL_ultimate}
  R_{PDL}^{mod} = \{(g_1,\dots,g_n,g,x_1,\dots,x_n,F_1,\dots,F_n),f(X) : F_i=g_i^{f(x_i)}, 1\leq i\leq n\},
\end{align}
where all $x_i$'s are distinct in $\mathbb{Z}_q$. The $R_{PDL}^{mod}$ is inspired from $R_{PDL}$ where 
CRS is included in the relation. Also, the aforementioned relation is based on a slightly 
different version of the original polynomial DL problem introduced in \cite{cryptoeprint:2023/1669}, 
defined as follows.

\begin{definition}[\textit{variant}- Polynomial Discrete Logarithm problem]
  Let\par 
  $\{g_i : g_i\neq g\}_{i=1}^n$ be a set of distinct generators for the prime order $q$ cyclic 
  group $\mathbb{G}$ generated by $g$. Given $F_1,\dots,F_n$ and distinct elements $x_1,\dots,x_n$ in 
  $\mathbb{Z}_q$, find a polynomial $f\in\mathbb{Z}_q[X]$ with degree at most $t$, where 
  $F_i=g_i^{f(x_i)}$ for $1\leq i\leq n$ with $t<n$.\par

  In other words, an algorithm $\mathcal{A}$ is said to have an advantage $\epsilon$ in solving \textit{variant}-PDL if 
  \begin{align*}
    Pr[\mathcal{A}(x_1,\dots,x_n,g,g_1,\dots,g_n,g_1^{f(x_1)},\dots,g_n^{f(x_n)})]\geq\epsilon,
  \end{align*}
  where $f\in\mathbb{Z}_q[X]$ is at most a $t$ degree polynomial with $t<n$ and the probability is over 
  distinct generators $g,g_1,\dots,g_n$ of $\mathbb{G}$ chosen at random and distinct $x_1,\dots,x_n$ 
  elements in $\mathbb{Z}_q$.
\end{definition}

\textbf{(TODO reduction to PDL)}\par

Now consider the CRS dependent language of $R_{PDL}^{mod}$ as follows:
\begin{align*}
  L_{g_1,\dots,g_n}^{PDL} = \{(g,x_1,\dots,x_n,F_1,\dots,F_n) : &\exists f\in\mathbb{Z}_q[X]_t,\\ 
  [(g_1,\dots,g_n,&g,x_1,\dots,x_n,F_1,\dots,F_n),f(X)]\in R_{PDL}^{mod}\}.
\end{align*}
We now present our NIZK AoK proof system $\pi_{PDL}^{AoK}$ for the relation $R_{PDL}^{mod}$ in the 
figure \ref{fig:aok-polynomial-dl}.\par

\input{figures/mod-polynomial-dl-ultimate.tex}

\begin{theorem}[A NIZK Argurement of Knowledge for $R_{PDL}^{mod}$]\label{th:variant_PDL security}
  Consider\par $(g,x_1,\dots,x_n,F_1,\dots,F_n)\in L_{g_1,\dots,g_n}^{PDL}$, where 
  $L_{g_1,\dots,g_n}^{PDL}$ is the CRS dependent language defined by the relation 
  $R_{PDL}^{mod}$,
  with its corresponding witness being $f\in\mathbb{Z}_q[X]_{\leq t}$.
  Assuming \textit{variant}-PDL is computationally hard, for 
  $0\leq t<n$, the protocol $\pi_{PDL}^{AoK}$ (described in figure \ref{fig:aok-polynomial-dl}) is a 
  NIZK AoK for $R_{PDL}^{mod}$ in the $RO$ model.
\end{theorem}
\begin{proof}
  The corresponding proof is similar to the proof of theorem \ref{th:PDL security} given in \cite{cryptoeprint:2023/1669}. 
  Formally, we will prove the security of the interactive setting (i.e., without $RO$ being used) and then 
  using Fiat-Shamir transform it can be extended to the non-interactive setting in the $RO$ model. 

  \begin{itemize}
    \item \textit{\textbf{Correctness}}: If both prover and verifier are honest, then 
      we have 
      \begin{align}\label{eq:v1_0_verify}
        \prod_{i=1}^{n}g_i^{z(i)}&=\prod_{i=1}^{n}g_i^{r(i)+df(i)}\nonumber\\
        &=(\prod_{i=1}^{n}g_i^{r(i)})(\prod_{i=1}^{n}g_i^{f(i)})^d\nonumber\\
        &=\Gamma [\prod_{i=1}^{n}F_i]^d.
      \end{align}
      The aforementioned computations imply that verification returns \textit{true} and honest verifier accepts the 
      honest prover.
    \item \textit{\textbf{Special Soundness}}: Let $(\Gamma,d,z(X))$, $(\Gamma,d',z'(X))$ 
      be any two acceptable transcripts where response polynomials will differ as a consequence of different challenge 
      values. We have the following from equation \ref{eq:v1_0_verify}:
      \begin{align*}
        \prod_{i=1}^{n}g_i^{z(x_i)}=\Gamma \left[\prod_{i=1}^{n}F_i\right]^d,\prod_{i=1}^{n}g_i^{z'(x_i)}=\Gamma \left[\prod_{i=1}^{n}F_i\right]^{d'};
      \end{align*}
      as $d\neq d'$, $d-d'$ is always invertible in the field $\mathbb{Z}_q$. This further implies
      the following:
      \begin{align}\label{eq:v1_0_Equality}
        \prod_{i=1}^{n}g_i^{z(x_i)-z'(x_i)}=\left[\prod_{i=1}^{n}F_i\right]^{d-d'} \iff \prod_{i=1}^{n}g_i^{\frac{z(x_i)-z'(x_i)}{d-d'}}=\prod_{i=1}^{n}F_i.
      \end{align}
      As both transcripts are acceptable the verification should be successful in both cases, 
      then we have

      \begin{align}\label{eq:v1_i_Equality}
        F_i := g_i^{\frac{z(x_i)-z'(x_i)}{d-d'}}, 1\leq i\leq n.
      \end{align}

      Hence, equation \ref{eq:v1_i_Equality} imply that $f_i=\frac{z(x_i)-z'(x_i)}{d-d'}$ for 
      $1\leq i\leq n$. Moreover, as $z(X)$ is at most a $t$ degree 
      polynomial in $\mathbb{Z}_q[X]$, an extractor $\mathcal{E}$ can construct the unique $t$-degree 
      polynomial $f\in\mathbb{Z}_q[X]$, being the witness (resp. solution) for $R_{PDL}^{mod}$ relation (resp. \textit{variant}-PDL problem), 
      from any $t+1$ evaluation points in $\{f_i\}_{i=1}^n$ whenever $n>t$.
    \item \textit{\textbf{Honest Verifier Zero Knowledge (HVZK)}}: Given the statement\par $(g,x_1,\dots,x_n,F_1,\dots,F_n)\in L_{g_1,\dots,g_n}^{PDL}$  
      and a challenge value $d$, a simulator $\mathcal{S}$ can choose a polynomial $z'\in\mathbb{Z}_q[X]_{t}$ uniformly 
      at random and sets $\Gamma'=\frac{\prod_{i=1}^{n}g_i^{z'(x_i)}}{[\prod_{i=1}^{n}F_i]^d}$. 
      Now, $\mathcal{S}$ returns $(\Gamma',z'(X))$ as the simulated proof. As $z(X)$ is a random 
      degree $t$-polynomial in $\mathbb{Z}_q[X]$ and $z'(X)$ is chosen uniformly at random, 
      the simulated proof of $\mathcal{S}$ is indistinguishable from the real one.
  \end{itemize}
  As the interactive scheme is public coin, satisfies \textit{completeness}, (computational) \textit{Special Soundness} 
  and (computational) \textit{HVZK}, then in the random oracle ($RO$) model, using Fiat-Shamir transform \cite{10.1007/3-540-47721-7_12}, 
  it can be turned into a NIZK Argument of Knowledge for $R_{PDL}^{mod}$ (defined in equation \ref{eq:relation_mod_PDL_ultimate}).
\end{proof}

\subsection{Version 2}
\label{subsec:AoK_mod_pdl}
Consider the set $\{g_i\}_{i=-(\ell-1)}^n$ containing $n+\ell$ distinct generators (obtained as CRS) of 
the prime order $q$ cyclic group $\mathcal{G}$ different from $g$ with $g$ also being a generator of 
$\mathbb{G}$, where $n+\ell<\varphi(q)$ and $\varphi(q)$ is
the total number of distinct generators of the cyclic group $\mathbb{G}$. Consider the following relation for 
some polynomial $f\in\mathbb{Z}_q[X]_{t+\ell-1}$ with $t\leq n$:
\begin{align}\label{eq:new_mod_PDL}
  R_{mod-PDL} = \{(g_{-(\ell-1)},\dots,g_n,g,&x_{-(\ell-1)},\dots,x_n,F_0,\dots,F_n),f(X) :\nonumber\\
   &F_0=\prod_{i=-(\ell-1)}^{0}g_i^{f(x_i)}, F_i=g_i^{f(x_i)}, 1\leq i\leq n\},
\end{align}
where all $x_i$'s are distinct in $\mathbb{Z}_q$. The $R_{mod-PDL}$ is based on \textit{modified}-PDL 
(inspired from the PDL in \cite{cryptoeprint:2023/1669}) which is defined in the following.

\begin{definition}[\textit{modified}- Polynomial Discrete Logarithm problem]
  Let\par 
  $\{g_i : g_i\neq g\}_{i=-(\ell-1)}^n$ be a set of distinct generators for the prime order $q$ cyclic 
  group $\mathbb{G}$ generated by $g$. Given $F_0,\dots,F_n$ and distinct elements $x_{-(\ell-1)},\dots,x_n$ in 
  $\mathbb{Z}_q$, find a polynomial $f\in\mathbb{Z}_q[X]$ with degree at most $t+\ell-1$, where $F_0=\prod_{i=-(\ell-1)}^{0}g_i^{f(x_i)}$ and
  $F_i=g_i^{f(x_i)}$ for $1\leq i\leq n$ with $t\leq n$.\par

  In other words, an algorithm $\mathcal{A}$ is said to have an advantage $\epsilon$ in solving \textit{modified}-PDL if 
  \begin{align*}
    Pr[\mathcal{A}(x_{-(\ell-1)},\dots,x_n,g,g_{-(\ell-1)},\dots,g_n,\prod_{i=-(\ell-1)}^{0}g_i^{f(x_i)},g_1^{f(x_1)},\dots,g_n^{f(x_n)})]\geq\epsilon,
  \end{align*}
  where $f\in\mathbb{Z}_q[X]$ is at most a $t+\ell-1$ degree polynomial with $t\leq n$ and the probability is over 
  distinct generators $g,g_{-(\ell-1)},\dots,g_n$ of $\mathbb{G}$ chosen at random and distinct $x_{-(\ell-1)},\dots,x_0,\dots,x_n$ 
  elements in $\mathbb{Z}_q$.
\end{definition}

It is intuitive to observe that the \textit{modified}-PDL problem can be reduced to the 
Discrete Logarithm (DL) problem. \textbf{(TODO reduction to DL)}\par

Now consider the CRS dependent language of $R_{mod-PDL}$ as follows:
\begin{align*}
  L_{g_{-(\ell-1)},\dots,g_n}^{mod-PDL} = \{(g,x_{-(\ell-1)},\dots,x_n,F_0,\dots,F_n) : &\exists f\in\mathbb{Z}_q[X]_{t+\ell-1},\\ 
  [(g_{-(\ell-1)},\dots,g_n,g,x_{-(\ell-1)},&\dots,x_n,F_0,\dots,F_n),f(X)]\in R_{PDL}^{mod}\}.
\end{align*}

We will now present a new NIZK AoK $\pi_{mod-PDL}^{AoK}$ for the aforementioned relation 
$R_{mod-PDL}$ in the figure \ref{fig:mod-polynomial-dl}.

\input{figures/mod-polynomial-dl.tex}

\begin{theorem}[A NIZK Argurement of Knowledge for $R_{mod-PDL}$]\label{th:modified_PDL security}
  Consider\par $(g,x_{-(\ell-1)},\dots,x_n,F_0,\dots,F_n)\in L_{g_{-(\ell-1)},\dots,g_n}^{mod-PDL}$, where 
  $L_{g_{-(\ell-1)},\dots,g_n}^{mod-PDL}$ is the CRS dependent language defined by the relation 
  $R_{mod-PDL}$,
  with its corresponding witness being $f\in\mathbb{Z}_q[X]_{\leq t+\ell-1}$.
  Assuming \textit{modified}-PDL is computationally hard, for 
  $0\leq t+\ell\leq n$, the protocol $\pi_{mod-PDL}^{AoK}$ (described in figure \ref{fig:mod-polynomial-dl}) is a 
  NIZK AoK for $R_{mod-PDL}$ in the $RO$ model.
\end{theorem}
\begin{proof}
  The corresponding proof is similar to the proof of aforementioned theorem \ref{th:variant_PDL security}. 
  Formally, we will prove the security of the interactive setting (i.e., without $RO$ being used) and then 
  using Fiat-Shamir transform it can be extended to the non-interactive setting in the $RO$ model. 

  \begin{itemize}
    \item \textit{\textbf{Correctness}}: If both prover and verifier are honest, then
      we have 
      \begin{align}\label{eq:0_verify}
        \prod_{i=-(\ell-1)}^{n}g_i^{z(i)}&=\prod_{i=-(\ell-1)}^{n}g_i^{r(i)+df(i)}\nonumber\\
        &=(\prod_{i=-(\ell-1)}^{n}g_i^{r(i)})(\prod_{i=-(\ell-1)}^{n}g_i^{f(i)})^d\nonumber\\
        &=\Gamma \prod_{i=-(\ell-1)}^{0}g_i^{f(i)}\left[\prod_{i=1}^{n}F_i\right]^d\nonumber\\
        &=\Gamma \left[\prod_{i=0}^{n}F_i\right]^d\nonumber\\
      \end{align}
      The aforementioned computations imply that verification returns \textit{true} and honest verifier accepts the 
      honest prover.
    \item \textit{\textbf{Special Soundness}}: Let $(\Gamma,d,z(X))$, $(\Gamma,d',z'(X))$ 
      be any two acceptable transcripts where response polynomials will differ as a consequence of different challenge 
      values. We have the following from equation \ref{eq:0_verify}:
      \begin{align*}
        \prod_{i=-(\ell-1)}^{n}g_i^{z(x_i)}=\Gamma \left[\prod_{i=0}^{n}F_i\right]^d,\prod_{i=-(\ell-1)}^{n}g_i^{z'(x_i)}=\Gamma \left[\prod_{i=0}^{n}F_i\right]^{d'};
      \end{align*}
      as $d\neq d'$, $d-d'$ is always invertible in the field $\mathbb{Z}_q$. This further implies 
      the following:
      \begin{align}\label{eq:0_Equality}
        \prod_{i=-(\ell-1)}^{n}g_i^{z(x_i)-z'(x_i)}=\left[\prod_{i=0}^{n}F_i\right]^{d-d'} \iff \prod_{i=-(\ell-1)}^{n}g_i^{\frac{z(x_i)-z'(x_i)}{d-d'}}=\prod_{i=0}^{n}F_i.
      \end{align}

      As both transcripts are acceptable the verification should be successful in both cases, 
      then we have

      \begin{align}\label{eq:v1_i_Equality}
        F_i := g_i^{\frac{z(x_i)-z'(x_i)}{d-d'}}, 1\leq i\leq n,
      \end{align}
      and 
      \begin{align}\label{eq:v1_0_Equality}
        F_0 := \prod_{i=-(\ell-1)}^{0}g_i^{\frac{z(x_i)-z'(x_i)}{d-d'}}.
      \end{align}
      As long as $n\geq t+\ell$, any extractor can use equation \ref{eq:v1_i_Equality} to compute a unique $t+\ell-1$ 
      degree polynomial $f(X)$ from distinct evaluations $f_i=\frac{z(x_i)-z'(x_i)}{d-d'}$, for $1\leq i\leq n$, via language 
      interpolation. See that $f\in\mathbb{Z}_q[X]_{t+\ell-1}$ is the witness for $R_{mod-PDL}$ relation 
      (resp. solution for \textit{modified}-PDL problem).
    \item \textit{\textbf{Honest Verifier Zero Knowledge (HVZK)}}: Given the statement\par $(g,x_{-(\ell-1)},\dots,x_n,F_0,\dots,F_n)\in L_{g_{-(\ell-1)},\dots,g_n}^{mod-PDL}$  
      and a challenge value $d$, a simulator $\mathcal{S}$ can choose a polynomial $z'\in\mathbb{Z}_q[X]_{t+\ell-1}$ uniformly 
      at random and sets $\Gamma'=\frac{\prod_{i=-(\ell-1)}^{n}g_i^{z'(x_i)}}{[\prod_{i=0}^{n}F_i]^d}$. 
      Now, $\mathcal{S}$ returns $(\Gamma',z'(X))$ as the simulated proof. As $z(X)$ is a random 
      degree $t+\ell-1$-polynomial in $\mathbb{Z}_q[X]$ and $z'(X)$ is chosen uniformly at random, 
      the simulated proof of $\mathcal{S}$ is indistinguishable from the real one.
  \end{itemize}
  As the interactive scheme is public coin, satisfies \textit{completeness}, (computational) \textit{Special Soundness} 
  and (computational) \textit{HVZK}, then in the random oracle ($RO$) model, using Fiat-Shamir transform \cite{10.1007/3-540-47721-7_12}, 
  it can be turned into a NIZK Argument of Knowledge for $R_{PDL}^{mod}$ (defined in equation \ref{eq:relation_mod_PDL}).
\end{proof}

\section{A Publicly Verifiable Secret Sharing scheme}
\label{sec:PVSS}
In this section, we will present a new Publicly Verifiable Secret Sharing (PVSS) scheme, which is 
efficient in terms of verification time in comparison to the state-of-the-art PVSS $\Pi_{S}$ \cite{cryptoeprint:2023/1669}. 
It is important to note that the optimization comes with the cost of a slightly longer 
secret sharing time, but it can be neglected in practice. In a nutshell, we trade for more 
group multiplications in the sharing phase for a significant reduction in the  
number of group exponentiations in the verification phase.\par

Also, our new PVSS scheme is based on the NIZK AoK proof system $\pi_{PDL}^{AoK}$ found 
in figure \ref{fig:aok-polynomial-dl}. We denote our new PVSS scheme as $\Pi_{S}^{compact}$ and can 
be found in figure \ref{fig:compact-PVSS-ro}.

\input{figures/PVSS.tex}

\section{A Pre-Constructed Publicly Verifiable Secret Sharing scheme}
\label{sec:PPVSS}
As any PVSS scheme can be modified to a Pre-Constructed PVSS scheme, we will present a new 
PPVSS scheme constructed from the PVSS scheme $\Pi_{S}^{compact}$. Our new PPVSS scheme is 
based on the same NIZK AoK proof system $\pi_{PDL}^{AoK}$, which $\Pi_{S}^{compact}$ is based on. 
We denote our new PPVSS scheme as $\Lambda_{RO}^{compact}$ and can be found in figure 
\ref{fig:compact-PPVSS-ro}.
\input{figures/compact-PPVSS-ro.tex}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "thesis"
%%% End: 
